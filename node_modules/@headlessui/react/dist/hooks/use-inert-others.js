import{disposables as p}from'../utils/disposables.js';import{getOwnerDocument as E}from'../utils/owner.js';import{useIsoMorphicEffect as m}from'./use-iso-morphic-effect.js';let a=new Map,u=new Map;function s(t){var e;let r=(e=u.get(t))!=null?e:0;return u.set(t,r+1),r!==0?()=>c(t):(a.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>c(t))}function c(t){var n;let r=(n=u.get(t))!=null?n:1;if(r===1?u.delete(t):u.set(t,r-1),r!==1)return;let e=a.get(t);e&&(e["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",e["aria-hidden"]),t.inert=e.inert,a.delete(t))}function H({allowed:t=()=>[],disallowed:r=()=>[]}={},e=!0){m(()=>{if(!e)return;let n=p();for(let i of r())i&&n.add(s(i));let d=t();for(let i of d){if(!i)continue;let l=E(i);if(!l)continue;let o=i.parentElement;for(;o&&o!==l.body;){for(let f of o.children)d.some(h=>f.contains(h))||n.add(s(f));o=o.parentElement}}return n.dispose},[e,t,r])}export{H as useInertOthers};
